{% schema %}
{
  "name": "G-Grip Animated Rows",
  "settings": [
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding Top",
      "default": 60
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding Bottom",
      "default": 60
    }
  ],
  "blocks": [
    {
      "type": "stats_layout",
      "name": "Stats Layout",
      "settings": [
        {
          "type": "header",
          "content": "Left Column (Visual)"
        },
        {
          "type": "image_picker",
          "id": "main_image",
          "label": "Main Image (GIF)"
        },
        {
          "type": "header",
          "content": "Right Column (Data)"
        },
        {
          "type": "text",
          "id": "subheading",
          "label": "Sub-heading",
          "default": "INTELLIGENT INSIGHTS"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Train Smarter."
        },
        {
          "type": "image_picker",
          "id": "stat_image_1",
          "label": "Top Stats Image"
        },
        {
          "type": "image_picker",
          "id": "stat_image_2",
          "label": "Bottom Stats Image"
        }
      ]
    },
    {
      "type": "feature_layout",
      "name": "Feature Layout",
      "settings": [
        {
          "type": "checkbox",
          "id": "flip_layout",
          "label": "Flip Layout (Text Left, Image Right)",
          "default": false
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "subheading",
          "label": "Sub-heading",
          "default": "FEATURE HIGHLIGHT"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Feature Heading"
        },
        {
          "type": "richtext",
          "id": "text",
          "label": "Body Text",
          "default": "<p>Description of the feature goes here.</p>"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "G-Grip Animated Rows",
      "blocks": [
        {
          "type": "stats_layout"
        },
        {
          "type": "feature_layout"
        },
        {
          "type": "feature_layout",
          "settings": {
            "flip_layout": true
          }
        }
      ]
    }
  ]
}
{% endschema %}

{% style %}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top }}px;
    padding-bottom: {{ section.settings.padding_bottom }}px;
  }

  .animated-rows-section {
    background-color: #1b2028; /* Dark Blue-Grey/Charcoal */
    overflow-x: hidden; /* Mobile Safety */
    color: #cccccc;
  }

  .animated-row-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
    display: flex;
    flex-direction: column;
    gap: 80px; /* Space between rows */
  }

  .ar-row {
    display: flex;
    flex-direction: column; /* Stack on mobile */
    gap: 40px;
    align-items: center;
    width: 100%;
  }

  @media screen and (min-width: 750px) {
    .ar-row {
      flex-direction: row;
      justify-content: space-between;
      gap: 60px;
    }
  }

  /* Columns */
  .ar-col {
    flex: 1;
    width: 100%;
    position: relative;
    opacity: 0; /* Initial State */
    transition: all 1s ease-out;
  }

  .ar-col img {
    width: 100%;
    height: auto;
    display: block;
    border-radius: 12px;
  }

  /* Animation States */
  .ar-col-left {
    transform: translateX(-100px);
  }

  .ar-col-right {
    transform: translateX(100px);
  }

  /* Active Class */
  .ar-col.in-view {
    opacity: 1;
    transform: translateX(0);
  }

  /* Typography */
  .ar-subheading {
    color: #ff7700; /* Brand Orange */
    font-size: 1.4rem;
    text-transform: uppercase;
    letter-spacing: 2px;
    font-weight: 600;
    margin-bottom: 15px;
    display: block;
  }

  .ar-heading {
    color: #ffffff; /* White Bold */
    font-size: 3.2rem;
    font-weight: 700;
    margin-top: 0;
    margin-bottom: 20px;
    line-height: 1.2;
  }

  .ar-text {
    color: #cccccc; /* Light Grey */
    font-size: 1.6rem;
    line-height: 1.6;
    margin-bottom: 20px;
  }

  .ar-text p {
    margin-bottom: 1em;
  }

  /* Stats Block Specifics */
  .ar-stats-images {
    display: flex;
    flex-direction: column;
    gap: 20px; /* margin-bottom 20px equivalent */
  }

  .ar-stats-image-item {
      width: 100%;
  }

  /* Feature Block Content */
  .ar-content-wrapper {
      display: flex;
      flex-direction: column;
      justify-content: center;
      height: 100%;
  }

{% endstyle %}

<div class="animated-rows-section section-{{ section.id }}-padding">
  <div class="animated-row-container">
    {% for block in section.blocks %}
      <div class="ar-row-wrapper" {{ block.shopify_attributes }}>

        {% case block.type %}
          {% when 'stats_layout' %}
            <div class="ar-row">
              <!-- Left Column: Main GIF -->
              <div class="ar-col ar-col-left js-animate-row">
                {% if block.settings.main_image != blank %}
                  {{ block.settings.main_image | image_url: width: 800 | image_tag: loading: 'lazy' }}
                {% else %}
                  {{ 'image' | placeholder_svg_tag }}
                {% endif %}
              </div>

              <!-- Right Column: Data -->
              <div class="ar-col ar-col-right js-animate-row">
                <div class="ar-content-wrapper">
                  {% if block.settings.subheading != blank %}
                    <span class="ar-subheading">{{ block.settings.subheading }}</span>
                  {% endif %}
                  {% if block.settings.heading != blank %}
                    <h2 class="ar-heading">{{ block.settings.heading }}</h2>
                  {% endif %}

                  <div class="ar-stats-images">
                    <div class="ar-stats-image-item">
                       {% if block.settings.stat_image_1 != blank %}
                        {{ block.settings.stat_image_1 | image_url: width: 800 | image_tag: loading: 'lazy' }}
                      {% else %}
                        {{ 'product-1' | placeholder_svg_tag }}
                      {% endif %}
                    </div>
                    <div class="ar-stats-image-item">
                       {% if block.settings.stat_image_2 != blank %}
                        {{ block.settings.stat_image_2 | image_url: width: 800 | image_tag: loading: 'lazy' }}
                      {% else %}
                        {{ 'product-2' | placeholder_svg_tag }}
                      {% endif %}
                    </div>
                  </div>
                </div>
              </div>
            </div>

          {% when 'feature_layout' %}
            <div class="ar-row">
              {% if block.settings.flip_layout %}
                <!-- Flipped: Text Left, Image Right -->

                <!-- Text Column (Left) -->
                <div class="ar-col ar-col-left js-animate-row">
                   <div class="ar-content-wrapper">
                      {% if block.settings.subheading != blank %}
                        <span class="ar-subheading">{{ block.settings.subheading }}</span>
                      {% endif %}
                      {% if block.settings.heading != blank %}
                        <h2 class="ar-heading">{{ block.settings.heading }}</h2>
                      {% endif %}
                      {% if block.settings.text != blank %}
                        <div class="ar-text">{{ block.settings.text }}</div>
                      {% endif %}
                   </div>
                </div>

                <!-- Image Column (Right) -->
                <div class="ar-col ar-col-right js-animate-row">
                  {% if block.settings.image != blank %}
                    {{ block.settings.image | image_url: width: 800 | image_tag: loading: 'lazy' }}
                  {% else %}
                    {{ 'image' | placeholder_svg_tag }}
                  {% endif %}
                </div>

              {% else %}
                <!-- Default: Image Left, Text Right -->

                 <!-- Image Column (Left) -->
                <div class="ar-col ar-col-left js-animate-row">
                  {% if block.settings.image != blank %}
                    {{ block.settings.image | image_url: width: 800 | image_tag: loading: 'lazy' }}
                  {% else %}
                    {{ 'image' | placeholder_svg_tag }}
                  {% endif %}
                </div>

                <!-- Text Column (Right) -->
                 <div class="ar-col ar-col-right js-animate-row">
                   <div class="ar-content-wrapper">
                      {% if block.settings.subheading != blank %}
                        <span class="ar-subheading">{{ block.settings.subheading }}</span>
                      {% endif %}
                      {% if block.settings.heading != blank %}
                        <h2 class="ar-heading">{{ block.settings.heading }}</h2>
                      {% endif %}
                      {% if block.settings.text != blank %}
                        <div class="ar-text">{{ block.settings.text }}</div>
                      {% endif %}
                   </div>
                </div>
              {% endif %}
            </div>

        {% endcase %}
      </div>
    {% endfor %}
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    const observerOptions = {
      root: null,
      rootMargin: "0px",
      threshold: 0.1
    };

    const observer = new IntersectionObserver((entries, observer) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add("in-view");
          // Optional: Stop observing once animated
          observer.unobserve(entry.target);
        }
      });
    }, observerOptions);

    const elements = document.querySelectorAll('.js-animate-row');
    elements.forEach(el => observer.observe(el));
  });
</script>
